<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>vuejs</title>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <!-- JavaScript Bundle with Popper -->

</head>

<body>
    <div id="app">
        <div class="container">
            <h1> {{titulo}}</h1>
            <button @click.stop.prevent="getUsers()" class="btn btn-success">get users</button>
            <div v-if="response.status==='error'" class="alert alert-danger">{{response.msg}}</div>

            <div v-if="loader.users" class="alert alert-primary">
                Carregando usuários
            </div>

            <ul>
                <li v-for="user in users">{{user.name}}</li>
            </ul>
        </div>
    </div> <!-- fim div app -->



    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue-resource@1.5.3"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>



        var mixin = {
            methods: {
                getUsers() {
                    this.loader.users = true;

                    var url = 'http://jsonplaceholder.typicode.com/users';
                    var vm = this;

                    axios.get(url).then(function(r){
                        console.log(r);
                        vm.users = r.data;//esse this vai dar erro porque está pegando da função, então tem que fazer uma... 
                        vm.loader.users = false; //... variável do this fora da função
                    });

                    /* this.$http.get(url).then(function (r) { //vue-resource é usado com this.$http e o método
                        this.users = r.body;
                    },
                        function (error) {
                            this.response.status = "error"
                            console.log(error);
                        })
                        .finally(function(){
                            this.loader.users = false;
                        });//quando o get for executada fará o (then) */
                }
            }
        }

        var app = new Vue({

            mixins: [mixin],

            el: "#app",


            data: {// elementos 
                titulo: "Curso Vuejs",
                users: [],
                loader:{
                    users: false,
                },
                response: {
                    msg: "Error 404",
                    status: ""
                }
            },

            computed: {//rotinas (roda sempre que há alterações) e retorna valores

            },

            watch: {//assiste quando uma variável for alterada

            },

            methods: {//rotinas e funções para serem acessadas por fora


            }

        });

    </script>
</body>

</html>